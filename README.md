# Energy Arbitrage Integration –¥–ª—è Home Assistant

–ö–∞—Å—Ç–æ–º–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è Home Assistant, —Ä–µ–∞–ª–∏–∑—É—é—â–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –∞—Ä–±–∏—Ç—Ä–∞–∂ —Å —Å–æ–ª–Ω–µ—á–Ω—ã–º–∏ –ø–∞–Ω–µ–ª—è–º–∏ –∏ –±–∞—Ç–∞—Ä–µ—è–º–∏.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîã **–£–º–Ω—ã–π –∞—Ä–±–∏—Ç—Ä–∞–∂**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–∫—É–ø–∫–∞ –¥–µ—à–µ–≤–æ–π –∏ –ø—Ä–æ–¥–∞–∂–∞ –¥–æ—Ä–æ–≥–æ–π —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏
- ‚òÄÔ∏è **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–æ–ª–Ω–µ—á–Ω—ã–º–∏ –ø–∞–Ω–µ–ª—è–º–∏**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ–ª–Ω–µ—á–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏
- üìä **MQTT –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—á–∞—Å–æ–≤—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ —á–µ—Ä–µ–∑ MQTT
- ‚ö° **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ—Ä—Ç–æ—Ä–æ–º**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–±–æ—Ç—ã
- üéõÔ∏è **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**: –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ UI Home Assistant
- üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–µ–Ω—Å–æ—Ä—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ß–µ—Ä–µ–∑ HACS (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ HACS –≤ Home Assistant
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Integrations"
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç—Ä–∏ —Ç–æ—á–∫–∏ –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É
4. –í—ã–±–µ—Ä–∏—Ç–µ "Custom repositories"
5. –î–æ–±–∞–≤—å—Ç–µ URL: `https://github.com/rviar/ha-energy-arbitrage`
6. –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é "Integration"
7. –ù–∞–∂–º–∏—Ç–µ "Add"
8. –ù–∞–π–¥–∏—Ç–µ "Energy Arbitrage" –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–∞—á–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–ª–∏–∑
2. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –≤ –ø–∞–ø–∫—É `custom_components/energy_arbitrage/`
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Home Assistant

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ë–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:

1. **–°–æ–ª–Ω–µ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** (ha-solarman):
   - `sensor.inverter_pv_power` - —Ç–µ–∫—É—â–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
2. **–ü—Ä–æ–≥–Ω–æ–∑ —Å–æ–ª–Ω–µ—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏** (ha-solcast-solar):

   - `sensor.solcast_pv_forecast_forecast_today`
   - `sensor.solcast_pv_forecast_forecast_tomorrow`

3. **–ë–∞—Ç–∞—Ä–µ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**:

   - `sensor.inverter_battery` - —É—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞ (%)
   - `sensor.inverter_battery_power` - –º–æ—â–Ω–æ—Å—Ç—å –∑–∞—Ä—è–¥–∞/—Ä–∞–∑—Ä—è–¥–∞

4. **–≠–Ω–µ—Ä–≥–æ—Å–∏—Å—Ç–µ–º–∞**:

   - `sensor.inverter_load_power` - –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –¥–æ–º–∞
   - `sensor.inverter_grid_power` - –∏–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç –≤ —Å–µ—Ç—å

5. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ—Ä—Ç–æ—Ä–æ–º**:

   - `select.inverter_work_mode` - —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
   - `switch.inverter_battery_grid_charging` - –∑–∞—Ä—è–¥ —Å —Å–µ—Ç–∏

6. **MQTT —Ç–∞—Ä–∏—Ñ—ã** (ha_Pstryk):
   - –¢–æ–ø–∏–∫ `energy/forecast/buy` - —Ç–∞—Ä–∏—Ñ—ã –ø–æ–∫—É–ø–∫–∏
   - –¢–æ–ø–∏–∫ `energy/forecast/sell` - —Ç–∞—Ä–∏—Ñ—ã –ø—Ä–æ–¥–∞–∂–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Devices & Services**
2. –ù–∞–∂–º–∏—Ç–µ **Add Integration**
3. –ù–∞–π–¥–∏—Ç–µ **Energy Arbitrage**
4. –°–ª–µ–¥—É–π—Ç–µ –º–∞—Å—Ç–µ—Ä—É –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

#### –®–∞–≥ 1: –°–µ–Ω—Å–æ—Ä—ã —Å–æ–ª–Ω–µ—á–Ω–æ–π –∏ —ç–Ω–µ—Ä–≥–æ—Å–∏—Å—Ç–µ–º—ã

- –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–∏ entity_id –¥–ª—è –≤—Å–µ—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤
- –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ–¥ –≤–∞—à–∏ entity_id

#### –®–∞–≥ 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ—Ä—Ç–æ—Ä–æ–º

- –í—ã–±–µ—Ä–∏—Ç–µ select –∏ switch –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω–≤–µ—Ä—Ç–æ—Ä–æ–º

#### –®–∞–≥ 3: MQTT —Ç–∞—Ä–∏—Ñ—ã

- –£–∫–∞–∂–∏—Ç–µ MQTT —Ç–æ–ø–∏–∫–∏ –¥–ª—è —Ç–∞—Ä–∏—Ñ–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)

#### –®–∞–≥ 4: –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å –ø–∞–Ω–µ–ª–µ–π: **10.6 –∫–í—Ç**
- –ï–º–∫–æ—Å—Ç—å –±–∞—Ç–∞—Ä–µ–∏: **15 –∫–í—Ç‚ãÖ—á**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑–µ—Ä–≤: **20%**
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±–∞—Ç–∞—Ä–µ–∏: **90%**
- –ò –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

## –°–æ–∑–¥–∞–≤–∞–µ–º—ã–µ entity

### –°–µ–Ω—Å–æ—Ä—ã

- `sensor.energy_arbitrage_next_action` - –°–ª–µ–¥—É—é—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–∏—Å—Ç–µ–º—ã
- `sensor.energy_arbitrage_target_power` - –¶–µ–ª–µ–≤–∞—è –º–æ—â–Ω–æ—Å—Ç—å –∑–∞—Ä—è–¥–∞/—Ä–∞–∑—Ä—è–¥–∞
- `sensor.energy_arbitrage_profit_forecast` - –ü—Ä–æ–≥–Ω–æ–∑ –ø—Ä–∏–±—ã–ª–∏ (EUR)
- `sensor.energy_arbitrage_battery_target` - –¶–µ–ª–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞ –±–∞—Ç–∞—Ä–µ–∏
- `sensor.energy_arbitrage_roi` - –û–∂–∏–¥–∞–µ–º–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å (%)
- `sensor.energy_arbitrage_status` - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

### –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏

- `switch.energy_arbitrage_enabled` - –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞
- `switch.energy_arbitrage_emergency_mode` - –ê–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º

### –°–µ–ª–µ–∫—Ç–æ—Ä—ã

- `select.energy_arbitrage_strategy` - –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞

## –°–µ—Ä–≤–∏—Å—ã

### `energy_arbitrage.recalculate`

–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.

### `energy_arbitrage.set_battery_reserve`

```yaml
service: energy_arbitrage.set_battery_reserve
data:
  reserve_percent: 25
```

### `energy_arbitrage.manual_override`

```yaml
service: energy_arbitrage.manual_override
data:
  hours: 2
```

### `energy_arbitrage.clear_manual_override`

–û—Ç–º–µ–Ω–∞ —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

### `energy_arbitrage.force_work_mode`

```yaml
service: energy_arbitrage.force_work_mode
data:
  work_mode: 'Export First'
  duration_minutes: 30
```

### `energy_arbitrage.force_grid_charging`

```yaml
service: energy_arbitrage.force_grid_charging
data:
  enable: true
  duration_minutes: 60
```

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—É—é –∏–µ—Ä–∞—Ä—Ö–∏—é** –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —ç–Ω–µ—Ä–≥–∏–µ–π:

```
–ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚Üí –ü–æ–∏—Å–∫ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–ª–Ω–µ—á–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π ‚Üí –ü–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ ‚Üí –£–¥–µ—Ä–∂–∞–Ω–∏–µ
```

#### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

1. **–õ–∏–º–∏—Ç –¥–Ω–µ–≤–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ –±–∞—Ç–∞—Ä–µ–∏**

   - –ü—Ä–æ–≤–µ—Ä–∫–∞: `today_cycles ‚â• max_daily_cycles` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2.0)
   - –ï—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω ‚Üí `HOLD` (–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π)

2. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –∞—Ä–±–∏—Ç—Ä–∞–∂–∞**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞: `battery_level ‚â• 40%`
   - –ï—Å–ª–∏ –Ω–∏–∂–µ ‚Üí `HOLD` (–∑–∞—â–∏—Ç–∞ –±–∞—Ç–∞—Ä–µ–∏)

#### üî¥ –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ü—Ä–æ–¥–∞–∂–∞ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ (`sell_arbitrage`)

**–£—Å–ª–æ–≤–∏—è:**

- ‚úÖ ROI ‚â• 5% (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –º–∞—Ä–∂–∞)
- ‚úÖ –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤ 24—á –ø–µ—Ä–∏–æ–¥–µ
- ‚úÖ –ë–∞—Ç–∞—Ä–µ—è –≤—ã—à–µ —Ä–µ–∑–µ—Ä–≤–∞ + 10% –±—É—Ñ–µ—Ä
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–∞ —ç–Ω–µ—Ä–≥–∏—è –¥–ª—è —Ä–∞–∑—Ä—è–¥–∫–∏

**–î–µ–π—Å—Ç–≤–∏–µ:** –†–∞–∑—Ä—è–¥–∫–∞ –±–∞—Ç–∞—Ä–µ–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ —ç–Ω–µ—Ä–≥–∏–∏ –ø–æ –≤—ã—Å–æ–∫–∏–º —Ç–∞—Ä–∏—Ñ–∞–º

#### üü¢ –ü–†–ò–û–†–ò–¢–ï–¢ 2: –ü–æ–∫—É–ø–∫–∞ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ (`charge_arbitrage`)

**–£—Å–ª–æ–≤–∏—è:**

- ‚úÖ ROI ‚â• 5% –¥–ª—è –±—É–¥—É—â–µ–π –ø—Ä–æ–¥–∞–∂–∏
- ‚úÖ –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤ 24—á –ø–µ—Ä–∏–æ–¥–µ
- ‚úÖ –ë–∞—Ç–∞—Ä–µ—è –Ω–∏–∂–µ 95%

**–î–µ–π—Å—Ç–≤–∏–µ:** –ó–∞—Ä—è–¥–∫–∞ –±–∞—Ç–∞—Ä–µ–∏ –¥–µ—à–µ–≤–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–¥–∞–∂–∏

**üîÑ –û—Å—Ç–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω–≤–µ—Ä—Ç–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**

- **–ó–∞—Ä—è–¥–∫–∞ –æ—Ç —Å–æ–ª–Ω—Ü–∞:** –ò–Ω–≤–µ—Ä—Ç–µ—Ä —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞—Ä—è–¥–∫–æ–π –±–∞—Ç–∞—Ä–µ–∏ –æ—Ç PV
- **–≠–∫—Å–ø–æ—Ä—Ç –∏–∑–ª–∏—à–∫–æ–≤:** –ò–Ω–≤–µ—Ä—Ç–µ—Ä —Å–∞–º —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–∑–ª–∏—à–∫–∏ –≤ —Å–µ—Ç—å
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏:** –ò–Ω–≤–µ—Ä—Ç–µ—Ä —Å–∞–º —Ä–∞–∑—Ä—è–∂–∞–µ—Ç –±–∞—Ç–∞—Ä–µ—é –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è

_–°–∏—Å—Ç–µ–º–∞ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ –≤–º–µ—à–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –≤—ã–≥–æ–¥–Ω—ã—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π_

#### ‚ö™ –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: –£–¥–µ—Ä–∂–∞–Ω–∏–µ (`hold`)

–ï—Å–ª–∏ –Ω–∏ –æ–¥–Ω–æ —É—Å–ª–æ–≤–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ, —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è.

### –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä                 | –ó–Ω–∞—á–µ–Ω–∏–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                        |
| ------------------------ | -------- | --------------------------------- |
| **Min Arbitrage Margin** | 15%      | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –¥–ª—è –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ |
| **Max Daily Cycles**     | 2.0      | –ó–∞—â–∏—Ç–∞ –±–∞—Ç–∞—Ä–µ–∏ –æ—Ç –∏–∑–Ω–æ—Å–∞          |
| **Min Arbitrage Depth**  | 40%      | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ |

### –ê–Ω–∞–ª–∏–∑ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö** —á–µ—Ä–µ–∑ MQTT —Ç–æ–ø–∏–∫–∏
2. **–†–∞—Å—á–µ—Ç ROI** —Å —É—á–µ—Ç–æ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±–∞—Ç–∞—Ä–µ–∏ (90%)
3. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫–æ–Ω** –¥–ª—è –ø–æ–∫—É–ø–∫–∏/–ø—Ä–æ–¥–∞–∂–∏
4. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π** –ø–æ —É–±—ã–≤–∞–Ω–∏—é –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏

### –†–µ–∂–∏–º—ã –∏–Ω–≤–µ—Ä—Ç–æ—Ä–∞

- **Export First**: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ —Å–µ—Ç—å (–¥–ª—è –ø—Ä–æ–¥–∞–∂–∏)
- **Zero Export To Load**: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å–∞–º–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è (–¥–ª—è –∑–∞—Ä—è–¥–∞/—Ö—Ä–∞–Ω–µ–Ω–∏—è)

### –ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã

- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑–µ—Ä–≤ –±–∞—Ç–∞—Ä–µ–∏**: 20% (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- **Cooldown –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏**: 5 –º–∏–Ω—É—Ç
- **–ê–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞—Ä—è–¥–∞ –±–∞—Ç–∞—Ä–µ–∏
- **–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ Home Assistant

### –ü—Ä–∏–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞

```yaml
type: entities
title: Energy Arbitrage
entities:
  - sensor.energy_arbitrage_status
  - sensor.energy_arbitrage_next_action
  - sensor.energy_arbitrage_target_power
  - sensor.energy_arbitrage_profit_forecast
  - sensor.energy_arbitrage_roi
  - switch.energy_arbitrage_enabled
  - switch.energy_arbitrage_emergency_mode
  - select.energy_arbitrage_strategy
```

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

```yaml
automation:
  - alias: 'Energy Arbitrage Notification'
    trigger:
      - platform: state
        entity_id: sensor.energy_arbitrage_roi
        above: 10
    action:
      - service: notify.telegram
        data:
          message: "–í—ã–≥–æ–¥–Ω–∞—è –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å: {{ states('sensor.energy_arbitrage_roi') }}% ROI!"
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å MQTT

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MQTT –±—Ä–æ–∫–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–ø–∏–∫–∏ `energy/forecast/buy` –∏ `energy/forecast/sell`
- –î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –º–∞—Å—Å–∏–≤–∞

### –ü—Ä–æ–±–ª–µ–º—ã —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏–Ω–≤–µ—Ä—Ç–æ—Ä–æ–º

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å entity_id –∏–Ω–≤–µ—Ä—Ç–æ—Ä–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ select.inverter_work_mode –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–µ —Ä–µ–∂–∏–º—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ switch.inverter_battery_grid_charging

### –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –º–∞—Ä–∂–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5%)
- –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞ —Ç–∞—Ä–∏—Ñ–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞ –±–∞—Ç–∞—Ä–µ–∏ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑–µ—Ä–≤

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Issues**: [GitHub Issues](https://github.com/rviar/ha-energy-arbitrage/issues)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [Wiki](https://github.com/rviar/ha-energy-arbitrage/wiki)
- **Community**: [Home Assistant Community Forum](https://community.home-assistant.io/)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](LICENSE) —Ñ–∞–π–ª.

## Changelog

### v1.0.0

- –ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑
- –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∞—Ä–±–∏—Ç—Ä–∞–∂–∞
- MQTT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è —Ç–∞—Ä–∏—Ñ–æ–≤
- UI –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Å–µ–Ω—Å–æ—Ä–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤# ha-arbitrage-energy
